<!DOCTYPE html>
<html>

<head>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" type="image/x-icon" href="media/logo.ico">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="style-dark.css" media="(prefers-color-scheme: dark)">
  <link rel="stylesheet" href="style-light.css" media="(prefers-color-scheme: light)">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>MSP Manager</title>
</head>

<body>
  <div id="container">
    <div id="content-container">
      <div id="backdrop" class="acrylic">
        <div id="title">
          <img src="media/Logo.svg" id="logo" draggable="false">
          <h1>MSP Manager</h1>
        </div>
        <div id="searchbar">
          <input id="customer-select" title="Search customer" type="search" name="customer-input" list="customer-list"
            placeholder="Search customer">
          <datalist id="customer-list"></datalist>
          <label>
            <svg title="Upload MSP customers" class="icon" width="24" height="24" viewBox="0 0 96 96"
              xmlns="http://www.w3.org/2000/svg">
              <path
                d="M 19.326029,11.873407 H 76.678191 A 3.1867033,3.1867033 0 0 0 77.107334,5.5297426 L 76.678191,5.5 H 19.326029 a 3.1867033,3.1867033 0 0 0 -0.433392,6.343664 z M 47.509234,90.470257 48.006359,90.5 a 4.2489378,4.2489378 0 0 0 4.219196,-3.756061 l 0.02974,-0.492877 V 32.756936 l 13.996001,13.987503 a 4.2489378,4.2489378 0 0 0 5.608598,0.352662 l 0.3994,-0.352662 a 4.2489378,4.2489378 0 0 0 0.352662,-5.608598 l -0.352662,-0.3994 -21.231942,-21.231942 a 4.2489378,4.2489378 0 0 0 -5.608598,-0.352662 l -0.3994,0.352662 -21.261684,21.227693 a 4.2489378,4.2489378 0 0 0 5.608597,6.369158 L 29.76567,46.748688 43.757422,32.77818 v 53.472882 a 4.2489378,4.2489378 0 0 0 3.751812,4.219195 z"
                fill="currentColor" />
            </svg>
            <input type="file" accept=".csv, .mspcsv" id="import-button" />
          </label>
        </div>
        <div id="tenant-container">
          <div id="buttons-container" class="container">
            <button id="admincenter" is="msp-button" class="draggable" draggable="true" title="Microsoft Admin Center"
              url="https://admin.cloud.microsoft/Partner/BeginClientSession.aspx?CTID=<microsoftId>&CSDEST=o365admincenter"><img
                src="media/adminCenter.svg">
              <p>Admin center</p>
            </button>
            <button id="entra" is="msp-button" class="draggable" draggable="true" title="Microsoft Entra ID"
              url="https://aad.portal.azure.com/<primaryDomainName>"><img src="media/entra.svg">
              <p>Entra</p>
            </button>
            <button id="intune" is="msp-button" class="draggable" draggable="true" title="Microsoft Intune"
              url="https://intune.microsoft.com/<primaryDomainName>"><img src="media/intune.svg">
              <p>Intune</p>
            </button>
            <button id="exchange" is="msp-button" class="draggable" draggable="true"
              title="Microsoft Exchange Admin Center"
              url="https://admin.cloud.microsoft/exchange?delegatedOrg=<primaryDomainName>#/"><img
                src="media/exchange.svg">
              <p>Exchange</p>
            </button>
            <button id="sharepoint" is="msp-button" class="draggable" draggable="true"
              title="Microsoft Sharepoint Admin Center"
              url="https://admin.cloud.microsoft/Partner/beginclientsession.aspx?CTID=<microsoftId>&CSDEST=SharePoint"><img
                src="media/sharepoint.svg">
              <p>Sharepoint</p>
            </button>
            <button id="azure" is="msp-button" class="draggable" draggable="true" title="Microsoft Azure"
              url="https://portal.azure.com/<primaryDomainName>"><img src="media/azure.svg">
              <p>Azure</p>
            </button>
            <button id="teams" is="msp-button" class="draggable" draggable="true" title="Microsoft Teams Admin Center"
              url="https://admin.teams.microsoft.com/?delegatedOrg=<primaryDomainName>"><img src="media/teams.webp">
              <p>Teams</p>
            </button>
            <button id="defender" is="msp-button" class="draggable" draggable="true" title="Microsoft 365 Defender"
              url="https://security.microsoft.com/homepage?tid=<microsoftId>"><img src="media/defender.svg">
              <p>Defender</p>
            </button>
            <button id="purview" is="msp-button" class="draggable" draggable="true" title="Microsoft 365 Purview"
              url="https://purview.microsoft.com/home?tid=<microsoftId>"><img src="media/purview.svg">
              <p>Purview</p>
            </button>
            <button id="powerPlatform" is="msp-button" class="draggable" draggable="true" title="Microsoft Power Platform Admin"
              url="https://admin.powerplatform.microsoft.com/home/<microsoftId>"><img src="media/powerPlatform.svg">
              <p>Power Platform</p>
            </button>
          </div>
          <button title="Copy selected tenant ID" id="tenant-id" class="icon-button" disabled onclick="copyTenantID()">
            <svg class="icon" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M5.503 4.627 5.5 6.75v10.504a3.25 3.25 0 0 0 3.25 3.25h8.616a2.251 2.251 0 0 1-2.122 1.5H8.75A4.75 4.75 0 0 1 4 17.254V6.75c0-.98.627-1.815 1.503-2.123ZM17.75 2A2.25 2.25 0 0 1 20 4.25v13a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-13A2.25 2.25 0 0 1 8.75 2h9Zm0 1.5h-9a.75.75 0 0 0-.75.75v13c0 .414.336.75.75.75h9a.75.75 0 0 0 .75-.75v-13a.75.75 0 0 0-.75-.75Z"
                fill="currentColor" />
            </svg>
            <p>xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</p>
          </button>
          <button title="Copy selected tenant domain" id="tenant-domain" class="icon-button" disabled onclick="copyTenantDomain()">
            <svg class="icon" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M5.503 4.627 5.5 6.75v10.504a3.25 3.25 0 0 0 3.25 3.25h8.616a2.251 2.251 0 0 1-2.122 1.5H8.75A4.75 4.75 0 0 1 4 17.254V6.75c0-.98.627-1.815 1.503-2.123ZM17.75 2A2.25 2.25 0 0 1 20 4.25v13a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-13A2.25 2.25 0 0 1 8.75 2h9Zm0 1.5h-9a.75.75 0 0 0-.75.75v13c0 .414.336.75.75.75h9a.75.75 0 0 0 .75-.75v-13a.75.75 0 0 0-.75-.75Z"
                fill="currentColor" />
            </svg>
            <p>contoso.com</p>
          </button>
        </div>
        <div id="footer">
          <button title="Microsoft Partner Center" id="partner-button" class="icon-button half"
            onclick="window.open('https://partner.microsoft.com/commerce/customers/list', '_blank');">
            <img src="media/partnercenter.svg">
            <p>Partner Center</p>
          </button>
          <button title="Microsoft Lighthouse" id="lighthouse-button" class="icon-button half"
            onclick="window.open('https://lighthouse.microsoft.com/', '_blank');">
            <img src="media/lighthouse.webp">
            <p>Lighthouse</p>
          </button>
          <button title="Azure PIM requests" id="pim-button" class="icon-button"
            onclick="window.open('https://entra.microsoft.com/#view/Microsoft_Azure_PIMCommon/ActivationMenuBlade', '_blank');">
            <svg class="icon" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M14 14H4.253a2.249 2.249 0 0 0-2.25 2.249v.578c0 .892.32 1.756.9 2.435 1.565 1.834 3.951 2.74 7.097 2.74.715 0 1.39-.048 2.026-.141A2.524 2.524 0 0 1 12 21.5v-1.153c-.614.103-1.28.154-2 .154-2.738 0-4.704-.746-5.957-2.213a2.25 2.25 0 0 1-.54-1.462v-.577c0-.414.336-.75.75-.75h7.955A2.505 2.505 0 0 1 14 14.05V14ZM10 2.005a5 5 0 1 1 0 10 5 5 0 0 1 0-10Zm0 1.5a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7ZM15 15h-.5a1.5 1.5 0 0 0-1.5 1.5v5a1.5 1.5 0 0 0 1.5 1.5h6a1.5 1.5 0 0 0 1.5-1.5v-5a1.5 1.5 0 0 0-1.5-1.5H20v-1a2.5 2.5 0 0 0-5 0v1Zm1.5-1a1 1 0 1 1 2 0v1h-2v-1Zm2 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"
                fill="currentColor" />
            </svg>
            <p>Manage Azure PIM requests</p>
          </button>
        </div>
      </div>
    </div>
  </div>
</body>

<script src="app.js"></script>

</html>
